/*! Synless.js 1.1.0 | (c) Michael Welborn | Synless is MIT licensed */
(function(a,b){"use strict";"function"==typeof define&&define.amd?define(["exports","underscore","incremental-dom"],b):"undefined"==typeof exports?b(a.Synless={},a._,a.IncrementalDOM):b(exports,require("underscore"),require("incremental-dom"))})("undefined"==typeof self?this:self,function(a,b,c){"use strict";function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}function _arrayWithHoles(a){if(Array.isArray(a))return a}a.VERSION="1.1.0",a.options={variable:"data",collapse:!0,strip:!1},a.compile=function(a,b){return new Function(k(a,b))()},a.precompile=function(a,b){return"(function(){".concat(k(a,b),"}())")},a.template=function(b,d){var e=a.compile(b,d);return function(a,b,d){return c.patch(a,e.bind(d||this),b)}};var d=/<(\w+)/,e={base:"head",body:"html",caption:"table",col:"colgroup",colgroup:"table",dd:"dl",dt:"dl",figcaption:"figure",head:"html",legend:"fieldset",li:"ul",optgroup:"select",option:"select",param:"object",source:"video",style:"head",summary:"details",tbody:"table",td:"tr",tfoot:"table",th:"tr",thead:"table",title:"head",tr:"tbody",track:"video"};a.dom_parser=function(a){var c=b.last(a.match(d))||"",f=e[c.toLowerCase()]||"div",g=document.createElement(f);return g.innerHTML=a,g.childNodes};var f={},g={},h=[],i={},j=[],k=function(c,d){f=b.extend({},a.options,d),h=["_k=function(c){_.isObject(c)&&!_.isArray(c)&&(c=_.filter(_.keys(c),_.propertyOf(c)));_.isArray(c)&&(c=c.join(_w));return c;}","_w=' '","_e=_.each","_i=_.isEmpty","_t=IncrementalDOM.text","_o=IncrementalDOM.elementOpen","_c=IncrementalDOM.elementClose","_v=IncrementalDOM.elementVoid","_s=IncrementalDOM.skip","_a=IncrementalDOM.attributes","_d=IncrementalDOM.applyAttr","_p=IncrementalDOM.applyProp"],c=l(c),m(c);var e="var ".concat(h.join(","),";return function(").concat(f.variable,"){").concat(j.join(""),"};");return f={},g={},h=[],i={},j=[],e},l=function(c){return b.isString(c)&&(c=a.dom_parser(c)),c instanceof DocumentFragment&&(c=c.childNodes),(c instanceof NodeList||c instanceof HTMLCollection)&&(c=b.toArray(c)),(b.isUndefined(c)||null===c)&&(c=[]),b.isArray(c)||(c=[c]),c},m=function(a){return b.each(a,function(a){9===a.nodeType&&(a=a.documentElement),3===a.nodeType&&q(a),1===a.nodeType&&u(a)})},n="}",o="},this);",p="_t(_w);",q=function(a){var c=t(a.nodeValue);if(!f.strip||0<c.length){var d="_t("+(c===s?"_w":J(c))+");",e=""===c.trim(),g=b.last(j)===p,h=f.collapse&&g&&d===p,i=b.last(j)===n,k=b.last(j)===o,l=k&&j[j.length-2]===n;e&&l?j.splice(-2,0,d):e&&(k||i)?j.splice(-1,0,d):!h&&j.push(d)}},r=/[ \t\r\n\f]+/g,s=" ",t=function(a){return f.collapse&&(a=a.replace(r,s)),f.strip&&(a=a.trim()),a},u=function(a){var c=A(a),d=_slicedToArray(c,4),e=d[0],f=d[1],g=d[2],h=d[3];if(!b.has(e,"sl-omit")){var i=b.has(e,"sl-key")?e["sl-key"]:J(L("_k")),k=G(f);if(b.has(e,"sl-each")){var l=e["sl-each"],p=e["sl-as"]||"";p=p.split(","),b.each(b.range(3),function(a){return p[a]=p[a]||"_"+a}),i="".concat(p[1],"+").concat(i),p=p.join(","),j.push("_e(".concat(l,",function(").concat(p,"){"))}b.has(g,"class")&&(g["class"]="_k(".concat(g["class"],")")),b.has(e,"sl-empty")&&(e["sl-if"]="!(".concat(e["sl-empty"],")||_i(").concat(e["sl-empty"],")")),b.has(e,"sl-if")?j.push("if(".concat(e["sl-if"],"){")):b.has(e,"sl-elif")?j.push("else if(".concat(e["sl-elif"],"){")):b.has(e,"sl-else")&&j.push("else{"),b.has(e,"sl-skip")?F(a,i,k,g,h,"_s();"):b.has(e,"sl-text")?F(a,i,k,g,h,"_t(".concat(e["sl-text"],");")):b.has(e,"sl-eval")?j.push(e["sl-eval"]):b.isEmpty(a.childNodes)?B(a,i,k,g,h):(C(a,i,k,g,h),m(b.toArray(a.childNodes)),E(a)),(b.has(e,"sl-if")||b.has(e,"sl-elif")||b.has(e,"sl-else"))&&j.push(n),b.has(e,"sl-each")&&j.push(o)}},v=/^sl-/,w=/^sl-attr:/,x=/^sl-prop:/,y=/-(\w)/,z=function(a,b){return b.toUpperCase()},A=function(a){var c={},d={},e={},f=[];return b.each(a.attributes,function(a){if(x.test(a.nodeName)){var b=a.nodeName.replace(x,"").replace(y,z);f.push(b),e[b]=a.nodeValue}w.test(a.nodeName)?e[a.nodeName.replace(w,"")]=a.nodeValue:v.test(a.nodeName)?c[a.nodeName]=a.nodeValue:d[a.nodeName]=a.nodeValue}),[c,d,e,f]},B=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return D.apply(void 0,["_v"].concat(b))},C=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return D.apply(void 0,["_o"].concat(b))},D=function(a,c,d,e,f,g){b.each(g,function(a){return j.push("_a[".concat(J(a),"]=_p;"))}),j.push("".concat(a,"(").concat(H(c),",").concat(d)),("null"!==e||0<b.keys(f).length)&&j.push(",".concat(e)),b.each(f,function(a,b){return j.push(",".concat(J(b),",").concat(a))}),j.push(");"),b.each(g,function(a){return j.push("_a[".concat(J(a),"]=_d;"))})},E=function(a){j.push("_c("+H(a)+");")},F=function(a,b,c,d,e,f){C(a,b,c,d,e),j.push(f),E(a)},G=function(a){if(0===b.keys(a).length)return"null";if(a=b.map(b.keys(a).sort(),function(b){return"".concat(J(b),",").concat(J(a[b]))}),a="[".concat(a.join(","),"]"),b.has(i,a))return i[a];var c=L("_h");return h.push("".concat(c,"=").concat(a)),i[a]=c,c},H=function(a){return J(a.nodeName.toLowerCase())},I={"\n":"\\n","\r":"\\r","	":"\\t",'"':"\\\""},J=function(a){return"\""+b.reduce(b.pairs(I),function(a,b){var c=_slicedToArray(b,2),d=c[0],e=c[1];return a.split(d).join(e)},a)+"\""},K=function(a){return b.has(g,a)||(g[a]=0),g[a]++},L=function(a){return""+a+K(a)}});
