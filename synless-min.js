(function(a,b){"use strict";"function"==typeof define&&define.amd?define(["exports","underscore"],b):"undefined"==typeof exports?b(a.Synless={},a._):b(exports,require("underscore"))})("undefined"==typeof self?this:self,function(a,b){"use strict";function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}function _arrayWithHoles(a){if(Array.isArray(a))return a}a.VERSION="0.9.1",a.options={variable:"data",collapse:!0,strip:!1},a.compile=function(a,b){return new Function(j(a,b))()},a.precompile=function(a,b){return"(function(){".concat(j(a,b),"}())")},a.template=function(b,c){var d=a.compile(b,c);return function(a,b,c){return IncrementalDOM.patch(a,d.bind(c||this),b)}};var c=/<(\w+)/,d={base:"head",body:"html",caption:"table",col:"colgroup",colgroup:"table",dd:"dl",dt:"dl",figcaption:"figure",head:"html",legend:"fieldset",li:"ul",optgroup:"select",option:"select",param:"object",source:"video",style:"head",summary:"details",tbody:"table",td:"tr",tfoot:"table",th:"tr",thead:"table",title:"head",tr:"tbody",track:"video"};a.dom_parser=function(a){var e=b.last(a.match(c))||"",f=d[e.toLowerCase()]||"div",g=document.createElement(f);return g.innerHTML=a,g.childNodes};var e={},f={},g=[],h={},i=[],j=function(c,d){e=b.extend({},a.options,d),g=["cls=function(c){_.isObject(c)&&!_.isArray(c)&&(c=_.filter(_.keys(c),_.propertyOf(c)));_.isArray(c)&&(c=c.join(\" \"));return c;}","t=IncrementalDOM.text","o=IncrementalDOM.elementOpen","c=IncrementalDOM.elementClose","v=IncrementalDOM.elementVoid","s=IncrementalDOM.skip","a=IncrementalDOM.attributes","aa=IncrementalDOM.applyAttr","ap=IncrementalDOM.applyProp"],c=k(c),l(c);var j="var ".concat(g.join(","),";return function(").concat(e.variable,"){").concat(i.join(""),"};");return e={},f={},g=[],h={},i=[],j},k=function(c){return b.isString(c)&&(c=a.dom_parser(c)),c instanceof DocumentFragment&&(c=c.childNodes),(c instanceof NodeList||c instanceof HTMLCollection)&&(c=b.toArray(c)),(b.isUndefined(c)||null===c)&&(c=[]),b.isArray(c)||(c=[c]),c},l=function(a){return b.each(a,function(a){9!=a.nodeType||a!=a.documentElement,3==a.nodeType&&o(a),1==a.nodeType&&r(a)})},m="}",n="},this);",o=function(a){var c=q(a.nodeValue);if(!e.strip||0<c.length){var d="t("+G(c)+");",f=""==c.trim(),g=b.last(i)==m,h=b.last(i)==n,j=h&&i[i.length-2]==m;f&&j?i.splice(-2,0,d):f&&(h||g)?i.splice(-1,0,d):i.push(d)}},p=/\s+/g,q=function(a){return e.collapse&&(a=a.replace(p," ")),e.strip&&(a=a.trim()),a},r=function(a){var c=x(a),d=_slicedToArray(c,4),e=d[0],f=d[1],g=d[2],h=d[3],j=b.has(e,"sl-key")?e["sl-key"]:G(I("k")),k=D(f);if(b.has(e,"sl-each")){var o=e["sl-each"],p=e["sl-as"]||"";p=p.split(","),b.each(b.range(3),function(a){return p[a]=p[a]||"_"+a}),j="".concat(p[1],"+").concat(j),p=p.join(","),i.push("_.each(".concat(o,",function(").concat(p,"){"))}b.has(g,"class")&&(g["class"]="cls(".concat(g["class"],")")),b.has(e,"sl-empty")&&(e["sl-if"]="!(".concat(e["sl-empty"],")||_.isEmpty(").concat(e["sl-empty"],")")),b.has(e,"sl-if")?i.push("if(".concat(e["sl-if"],"){")):b.has(e,"sl-elif")?i.push("else if(".concat(e["sl-elif"],"){")):b.has(e,"sl-else")&&i.push("else{"),b.has(e,"sl-skip")?C(a,j,k,g,h,"s();"):b.has(e,"sl-text")?C(a,j,k,g,h,"t(".concat(e["sl-text"],");")):b.isEmpty(a.childNodes)?y(a,j,k,g,h):(z(a,j,k,g,h),l(b.toArray(a.childNodes)),B(a)),(b.has(e,"sl-if")||b.has(e,"sl-elif")||b.has(e,"sl-else"))&&i.push(m),b.has(e,"sl-each")&&i.push(n)},s=/^sl-/,t=/^sl-attr:/,u=/^sl-prop:/,v=/-(\w)/,w=function(a,b){return b.toUpperCase()},x=function(a){var c={},d={},e={},f=[];return b.each(a.attributes,function(a){if(u.test(a.nodeName)){var b=a.nodeName.replace(u,"").replace(v,w);f.push(b),e[b]=a.nodeValue}t.test(a.nodeName)?e[a.nodeName.replace(t,"")]=a.nodeValue:s.test(a.nodeName)?c[a.nodeName]=a.nodeValue:d[a.nodeName]=a.nodeValue}),[c,d,e,f]},y=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return A.apply(void 0,["v"].concat(b))},z=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return A.apply(void 0,["o"].concat(b))},A=function(a,c,d,e,f,g){b.each(g,function(a){return i.push("a[".concat(G(a),"]=ap;"))}),i.push("".concat(a,"(").concat(E(c),",").concat(d)),("null"!=e||0<b.keys(f).length)&&i.push(",".concat(e)),b.each(f,function(a,b){return i.push(",".concat(G(b),",").concat(a))}),i.push(");"),b.each(g,function(a){return i.push("a[".concat(G(a),"]=aa;"))})},B=function(a){i.push("c("+E(a)+");")},C=function(a,b,c,d,e,f){z(a,b,c,d,e),i.push(f),B(a)},D=function(a){if(0==b.keys(a).length)return"null";if(a=b.map(b.keys(a).sort(),function(b){return"".concat(G(b),",").concat(G(a[b]))}),a="[".concat(a.join(","),"]"),b.has(h,a))return h[a];var c=I("a");return g.push("".concat(c,"=").concat(a)),h[a]=c,c},E=function(a){return G(a.nodeName.toLowerCase())},F={"\n":"\\n","\r":"\\r","	":"\\t",'"':"\\\""},G=function(a){return"\""+b.reduce(b.pairs(F),function(a,b){var c=_slicedToArray(b,2),d=c[0],e=c[1];return a.split(d).join(e)},a)+"\""},H=function(a){return b.has(f,a)||(f[a]=0),f[a]++},I=function(a){return""+a+H(a)}});
